CC = gcc
CCOPTS = -c -g -Wall -ggdb
LINKOPTS = -g -pthread
LIBS = -lclamav -lpthread -lz
SUB = subprocess.c

# build all targets
all: decompress scan project 

# clear out executables and other intermediate files
clean:
	rm -rf *.o decompress scan project

# link stage
decompress: decompress.o
	$(CC) $(LINKOPTS) -o $@ $^ $(LIBS)

scan: scan.o
	$(CC) $(LINKOPTS) -o $@ $^ $(LIBS)

project: project.o
	$(CC) $(LINKOPTS) -o $@ $^ $(LIBS)

# compile stage
decompress.o: decompress.c
	$(CC) $(CCOPTS) -o $@ $<

scan.o: scan.c
	$(CC) $(CCOPTS) -o $@ $<

project.o: project.c 
	$(CC) $(CCOPTS) -o $@ $< $SUB

